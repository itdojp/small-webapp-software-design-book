---
title: "03. 結合の物差し（統合強度×距離×変動性）"
permalink: /chapters/03-coupling-balance-sdv/
show_nav: true
prev: /chapters/02-complexity-and-interaction/
next: /chapters/04-minimal-architecture-ts/
---

# 03. 結合の物差し（統合強度×距離×変動性）

## 目的

- 結合を「統合強度（S）×距離（D）×変動性（V）」で扱い、手当の優先順位を付ける
- 過剰設計（将来不確実性への先回り）を、観測可能な指標で抑制する

## 得られる判断能力

- 「結合＝知識の共有」として、依存関係を言語化できる
- S/D/V で結合を半定量評価し、改善の優先順位を付けられる
- 分離（抽象化・境界追加）と統合（まとめる）のトレードオフを説明できる

## 前提/用語

- **統合強度（S）**: 同時変更・同時デプロイが必要な強さ
- **距離（D）**: 依存が跨ぐ境界の遠さ（組織、レポジトリ、実行環境、ネットワーク）
- **変動性（V）**: 仕様/実装が変わる頻度と不確実性

## 要点

- S が強いほど、分離よりも「一体として扱う」ほうがコストが低い場合がある
- D が大きいほど、契約（インターフェース、合意、テスト）を強める必要が出る
- V が高い箇所に、固定的な抽象化を入れると破綻しやすい

補足: 本書でいう「結合」は、主に **知識の共有** として扱います。

- あるモジュールが、別モジュールの内部事情（データ構造、例外、順序、タイミング）を知っているほど、変更が波及しやすい
- 「知っていること」を減らす手段が、境界（契約）とテスト（契約の検証）です

## 例（ランニング例）

タスク管理を例に、S/D/V を当てはめます。

- 期限判定ロジック（`期限超過` の定義）を UI と API がそれぞれ独自実装している
  - S: 3（両方同時に直さないと破綻）
  - D: 2（同一リポジトリだが別領域）
  - V: 4（運用で頻繁にルールが変わる可能性）
  - 手当案: 期限判定を domain に集約し、UI/API は同一関数を利用する（知識の共有を domain 側に寄せる）

- メール通知（外部I/F）をユースケースが直接呼んでいる
  - S: 2（通知が失敗しても業務継続できる設計なら同時変更は必須ではない）
  - D: 4（ネットワーク越し、失敗・遅延を前提）
  - V: 3（通知要件が増える余地がある）
  - 手当案: 通知I/Fを adapter として分離し、ユースケースは「通知要求」を発行する（リトライ/監視は境界側に寄せる）

## 演習（最小1個）

「依存関係トップ 10」を列挙し、S/D/V を半定量で採点してください。

- 採点表は Appendix B を利用してください
- [Appendix B: テンプレ集]({{ '/appendix/B-templates/' | relative_url }})
- 記入例: [Appendix D: 記入例]({{ '/appendix/D-samples/' | relative_url }})
- 結果から「今すぐ手当する 1 つ」を選び、理由を 3 行で説明してください

## よくある失敗

- D が小さい（同一モジュール内）にもかかわらず、境界を増やして学習コストを上げる
- V が高い領域に「正しい抽象」を求め、結果として変更が困難になる
- S が強い領域を無理に分割し、同時変更が増える

## チェックリスト

- [ ] 依存関係の優先順位が明確（トップ 10 など）
- [ ] S/D/V を使って説明できる（感想ではなく観測）
- [ ] 「分ける/まとめる」の判断が、運用・テスト方針に接続している

## 前後リンク

- [目次]({{ '/chapters/' | relative_url }})
- [前章: 02. 複雑性の捉え方]({{ '/chapters/02-complexity-and-interaction/' | relative_url }})
- [次章: 04. 小規模TS向けの最小アーキテクチャ]({{ '/chapters/04-minimal-architecture-ts/' | relative_url }})
